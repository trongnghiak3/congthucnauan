<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title></title>
  <script src="https://cdn.tailwindcss.com"></script> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>

  <!-- Phần Menu -->
<nav class="bg-white shadow-md py-3 font-serif relative">
  <div class="container mx-auto flex justify-between items-center px-6">
    <!-- Logo -->
    <a href="/" class="text-3xl font-bold text-gray-700 hover:text-yellow-500 transition flex items-center">
      <i class="fa-solid fa-ice-cream mr-2 text-yellow-500"></i> KemRecipe
    </a>

    <!-- Menu Desktop -->
    <ul class="hidden md:flex space-x-8 text-lg font-medium">
      <li><a href="/" class="text-gray-600 hover:text-yellow-500 transition"><i class="fa-solid fa-house mr-1"></i>Trang chủ</a></li>
      <li><a href="/cong-thuc" class="text-gray-600 hover:text-yellow-500 transition"><i class="fa-solid fa-utensils mr-1"></i>Công thức</a></li>
      <li><a href="/danh-muc" class="text-gray-600 hover:text-yellow-500 transition"><i class="fa-solid fa-folder-open mr-1"></i>Danh mục</a></li>
      <li><a href="/yeu-thich" class="text-gray-600 hover:text-yellow-500 transition"><i class="fa-solid fa-heart mr-1"></i>Yêu thích</a></li>
      <li><a href="/tim-kiem" class="text-gray-600 hover:text-yellow-500 transition"><i class="fa-solid fa-magnifying-glass mr-1"></i>Tìm kiếm</a></li>
      <li><a href="/gioi-thieu" class="text-gray-600 hover:text-yellow-500 transition"><i class="fa-solid fa-circle-info mr-1"></i>Giới thiệu</a></li>
      <li><a href="/lien-he" class="text-gray-600 hover:text-yellow-500 transition"><i class="fa-solid fa-envelope mr-1"></i>Liên hệ</a></li>
    </ul>

    <!-- Người dùng / Đăng nhập -->
    <div class="flex items-center space-x-4">
      <% if (typeof user !== 'undefined' && user) { %>
        <!-- Profile Dropdown -->
        <div class="hidden md:block relative">
          <div id="user-avatar" class="flex items-center space-x-4 cursor-pointer">
            <img src="<%= user.avatar || '/default-avatar.png' %>" 
                 alt="User Avatar" 
                 class="w-10 h-10 rounded-full object-cover border-2 border-yellow-500">
            <span class="text-lg font-bold text-gray-800"><%= user.username %></span>
          </div>
          <div id="user-dropdown" class="absolute right-0 mt-2 w-48 bg-white shadow-lg rounded-lg hidden text-center">
            <a href="/profile" class="block px-4 py-2 text-gray-600 hover:text-yellow-500">
              <i class="fa-solid fa-user mr-2"></i>Thông tin cá nhân
            </a>
            <% if (user.role === 'admin') { %>
              <a href="/admin" class="block px-4 py-2 text-gray-600 hover:text-yellow-500">
                <i class="fa-solid fa-cogs mr-2"></i>Quản lý
              </a>
            <% } %>
            <a href="/logout" class="block px-4 py-2 text-gray-600 hover:text-yellow-500">
              <i class="fa-solid fa-right-from-bracket mr-2"></i>Đăng xuất
            </a>
          </div>
        </div>
      <% } else { %>
        <a href="/login" class="hidden md:flex items-center bg-yellow-500 text-white px-5 py-2 rounded-lg font-semibold hover:bg-yellow-600 transition">
          <i class="fa-solid fa-right-to-bracket mr-2"></i> Đăng nhập
        </a>
      <% } %>

      <!-- Menu Toggle Mobile -->
      <button class="md:hidden text-gray-600 text-2xl focus:outline-none" id="menu-toggle">
        <i class="fa-solid fa-bars"></i>
      </button>
    </div>
  </div>

  <!-- Menu Mobile -->
  <ul id="mobile-menu" class="md:hidden absolute top-16 left-0 w-full bg-white shadow-md hidden flex-col space-y-4 py-4 text-center">
    <li><a href="/" class="block text-gray-600 hover:text-yellow-500 transition py-2"><i class="fa-solid fa-house mr-1"></i>Trang chủ</a></li>
    <li><a href="/cong-thuc" class="block text-gray-600 hover:text-yellow-500 transition py-2"><i class="fa-solid fa-utensils mr-1"></i>Công thức</a></li>
    <li><a href="/danh-muc" class="block text-gray-600 hover:text-yellow-500 transition py-2"><i class="fa-solid fa-folder-open mr-1"></i>Danh mục</a></li>
    <li><a href="/yeu-thich" class="block text-gray-600 hover:text-yellow-500 transition py-2"><i class="fa-solid fa-heart mr-1"></i>Yêu thích</a></li>
    <li><a href="/tim-kiem" class="block text-gray-600 hover:text-yellow-500 transition py-2"><i class="fa-solid fa-magnifying-glass mr-1"></i>Tìm kiếm</a></li>
    <li><a href="/gioi-thieu" class="block text-gray-600 hover:text-yellow-500 transition py-2"><i class="fa-solid fa-circle-info mr-1"></i>Giới thiệu</a></li>
    <li><a href="/lien-he" class="block text-gray-600 hover:text-yellow-500 transition py-2"><i class="fa-solid fa-envelope mr-1"></i>Liên hệ</a></li>
    <% if (typeof user !== 'undefined' && user) { %>
      <li><a href="/cong-thuc-cua-toi" class="block text-gray-600 hover:text-yellow-500 transition py-2"><i class="fa-solid fa-utensils mr-1"></i>Công thức của tôi</a></li>
      <% if (user.role === 'admin') { %>
        <li><a href="/admin" class="block text-gray-600 hover:text-yellow-500 transition py-2"><i class="fa-solid fa-cogs mr-1"></i>Quản lý</a></li>
      <% } %>
      <li><a href="/profile" class="block text-gray-600 hover:text-yellow-500 transition py-2"><i class="fa-solid fa-user mr-2"></i>Thông tin cá nhân</a></li>
      <li><a href="/logout" class="block text-gray-600 hover:text-yellow-500 transition py-2"><i class="fa-solid fa-right-from-bracket mr-2"></i>Đăng xuất</a></li>
    <% } else { %>
      <li><a href="/login" class="block bg-yellow-500 text-white py-2 rounded-lg font-semibold hover:bg-yellow-600 transition"><i class="fa-solid fa-right-to-bracket mr-2"></i> Đăng nhập</a></li>
    <% } %>
  </ul>
</nav>




  <!-- Nội dung động -->
  <main>
    <%- include(viewPath) %>
  </main>

  <!-- Chân trang -->
  <%- include('../partials/footer') %>

</body>
<!-- JavaScript -->
<script>
  // Toggle menu mobile
  document.getElementById("menu-toggle").addEventListener("click", function () {
    let menu = document.getElementById("mobile-menu");
    menu.classList.toggle("hidden");
  });

  // Toggle user dropdown trên desktop
  document.getElementById("user-avatar")?.addEventListener("click", function () {
    let dropdown = document.getElementById("user-dropdown");
    dropdown.classList.toggle("hidden");
  });
</script>
</html>